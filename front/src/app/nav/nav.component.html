<div class="min-h-screen bg-slate-100 flex flex-col">

  <!-- TOPBAR -->
  <header class="flex items-center justify-between h-16 px-4 md:px-6 bg-slate-800 text-slate-100 shadow z-30">
    <!-- Hamburguesa (móvil) -->
    <button type="button"
      class="inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-slate-700 md:hidden"
      (click)="sidebarOpen = !sidebarOpen">
      <span class="sr-only">Abrir menú</span>
      <span class="block w-5 h-0.5 bg-slate-100 mb-1"></span>
      <span class="block w-5 h-0.5 bg-slate-100 mb-1"></span>
      <span class="block w-5 h-0.5 bg-slate-100"></span>
    </button>

    <!-- Logo / Título -->
    <a routerLink="/main" class="flex items-center gap-2">
      <div class="w-8 h-8 rounded-lg bg-sky-500 flex items-center justify-center text-white font-semibold">
        SS
      </div>
      <span class="font-semibold tracking-wide">SS1</span>
    </a>

    <!-- Usuario -->
    <div *ngIf="rol != null" class="flex items-center gap-3">
      <span class="text-xs md:text-sm text-slate-200">
        Rol: <span class="font-semibold">{{ rol }}</span>
      </span>

      <!-- Cerrar sesión -->
      <button type="button" (click)="logout()"
        class="inline-flex items-center gap-2 rounded-xl bg-red-600/90 px-3 py-2 text-xs font-semibold text-white hover:bg-red-600 active:bg-red-700 transition">
        <span>Cerrar sesión</span>
      </button>
    </div>
  </header>

  <!-- Overlay móvil -->
  <div class="fixed inset-0 bg-black/40 z-40 md:hidden" *ngIf="sidebarOpen" (click)="sidebarOpen = false"></div>

  <!-- WRAPPER -->
  <div class="flex flex-1">

    <!-- SIDEBAR -->
    <aside
      class="fixed inset-y-16 left-0 w-64 bg-slate-900 text-slate-100 transform transition-transform duration-200 -translate-x-full md:translate-x-0 md:static md:inset-y-0 md:h-auto z-50"
      [class.translate-x-0]="sidebarOpen">
      <nav class="h-full overflow-y-auto py-4 px-3">
        <!-- Sección común -->
        <div class="px-3 pb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider">
          General
        </div>

        <a routerLink="/main" routerLinkActive="bg-sky-500 text-slate-900" [routerLinkActiveOptions]="{ exact: true }"
          class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium hover:bg-slate-800 transition-colors"
          (click)="sidebarOpen = false">
          <span>Inicio</span>
        </a>

        <a *ngIf="rol != null" routerLink="/mi-perfil" routerLinkActive="bg-sky-500 text-slate-900"
          [routerLinkActiveOptions]="{ exact: true }"
          class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium hover:bg-slate-800 transition-colors"
          (click)="sidebarOpen = false">
          <span>Mi perfil</span>
        </a>

        <!-- PACIENTE -->
        <ng-container *ngIf="rol === 'PACIENTE'">
          <div class="mt-4 px-3 pb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider">
            Paciente
          </div>

          <a routerLink="/mis-citas" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Mis citas</span>
          </a>
          <a routerLink="/cita-agendar" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Agendar cita</span>
          </a>
          <a routerLink="/sesiones-citas" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Citas y sesiones</span>
          </a>

          <a routerLink="/pago-sesiones" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Pago sesiones</span>
          </a>

          <a routerLink="/mis-gastos" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Mis compras</span>
          </a>

          <a routerLink="/comprar" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Comprar</span>
          </a>
          <a routerLink="/receta-tareas" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Recetas y tareas</span>
          </a>
        </ng-container>

        <!-- TRABAJADOR -->
        <ng-container *ngIf="rol === 'TRABAJADOR'">
          <div class="mt-4 px-3 pb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider">
            Atención
          </div>

          <a routerLink="/cita-agendar" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Agendar cita</span>
          </a>

          <a routerLink="/ver-historia" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Ver historias</span>
          </a>

          <a routerLink="/historia-crear" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Crear historia</span>
          </a>
        </ng-container>

        <!-- ADMINISTRATIVO -->
        <ng-container *ngIf="rol === 'ADMINISTRATIVO'">
          <div class="mt-4 px-3 pb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider">
            Administrativo
          </div>

          <a routerLink="/entregar-venta" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Entregar ventas</span>
          </a>

          <a routerLink="/medicamentos" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Medicamentos</span>
          </a>

          <a routerLink="/reportes" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Reportes</span>
          </a>
        </ng-container>

        <!-- MANTENIMIENTO -->
        <ng-container *ngIf="rol === 'MANTENIMIENTO'">
          <div class="mt-4 px-3 pb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider">
            Mantenimiento
          </div>

          <a routerLink="/empresa" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Empresa</span>
          </a>
        </ng-container>

        <!-- ADMIN (todo) -->
        <ng-container *ngIf="rol === 'ADMIN'">
          <div class="mt-4 px-3 pb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider">
            Administración
          </div>

          <a routerLink="/usuario-create" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Crear usuario</span>
          </a>
          <a routerLink="/empresa" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Empresa</span>
          </a>
          <a routerLink="/lista-empleado" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Lista empleados</span>
          </a>

          <a routerLink="/area-crear" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Áreas y servicios</span>
          </a>

          <a routerLink="/medicamentos" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Medicamentos</span>
          </a>

          <a routerLink="/reportes" routerLinkActive="bg-sky-500 text-slate-900"
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm hover:bg-slate-800 transition-colors"
            (click)="sidebarOpen = false">
            <span>Reportes</span>
          </a>
        </ng-container>

      </nav>
    </aside>

    <!-- CONTENIDO -->
    <main class="flex-1 p-4 md:p-6">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>